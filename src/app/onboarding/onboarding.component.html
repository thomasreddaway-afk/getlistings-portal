<div class="onboarding-container">
  <!-- Progress bar -->
  <div class="progress-bar">
    <nz-progress 
      [nzPercent]="progress" 
      [nzShowInfo]="false" 
      nzStrokeColor="#1890ff">
    </nz-progress>
  </div>

  <!-- Step indicator -->
  <div class="step-indicator">
    <nz-steps [nzCurrent]="currentStep" nzSize="small">
      <nz-step *ngFor="let step of steps" [nzTitle]="step.title"></nz-step>
    </nz-steps>
  </div>

  <!-- Content area -->
  <div class="onboarding-content">
    <!-- Step 0: Welcome -->
    <div *ngIf="currentStep === 0" class="step-content welcome-step">
      <div class="welcome-icon">
        <i nz-icon nzType="rocket" nzTheme="twotone"></i>
      </div>
      <h1>{{ steps[0].title }}</h1>
      <p class="subtitle">{{ steps[0].description }}</p>
      
      <div class="benefits">
        <div class="benefit-item">
          <i nz-icon nzType="check-circle" nzTheme="fill"></i>
          <span>Find off-market listings before your competitors</span>
        </div>
        <div class="benefit-item">
          <i nz-icon nzType="check-circle" nzTheme="fill"></i>
          <span>Get instant alerts for new opportunities</span>
        </div>
        <div class="benefit-item">
          <i nz-icon nzType="check-circle" nzTheme="fill"></i>
          <span>Track your pipeline and close more deals</span>
        </div>
      </div>

      <button nz-button nzType="primary" nzSize="large" (click)="next()">
        Get Started
        <i nz-icon nzType="arrow-right"></i>
      </button>
    </div>

    <!-- Step 1: Location Preferences -->
    <div *ngIf="currentStep === 1" class="step-content">
      <h2>{{ steps[1].title }}</h2>
      <p class="subtitle">{{ steps[1].description }}</p>

      <!-- Suburb search -->
      <div class="suburb-search">
        <nz-input-group [nzSuffix]="suffixIconSearch">
          <input
            type="text"
            nz-input
            placeholder="Search suburbs..."
            [(ngModel)]="suburbSearch"
            (keyup.enter)="addSuburb(suburbSearch)"
          />
        </nz-input-group>
        <ng-template #suffixIconSearch>
          <i nz-icon nzType="search"></i>
        </ng-template>
      </div>

      <!-- Popular suburbs -->
      <div class="popular-suburbs">
        <h4>Popular Suburbs</h4>
        <div class="suburb-tags">
          <nz-tag
            *ngFor="let suburb of popularSuburbs"
            [nzColor]="selectedSuburbs.includes(suburb) ? 'blue' : 'default'"
            (click)="addSuburb(suburb)"
            style="cursor: pointer; margin: 4px;"
          >
            {{ suburb }}
          </nz-tag>
        </div>
      </div>

      <!-- Selected suburbs -->
      <div class="selected-suburbs" *ngIf="selectedSuburbs.length > 0">
        <h4>Your Suburbs ({{ selectedSuburbs.length }})</h4>
        <nz-tag
          *ngFor="let suburb of selectedSuburbs"
          nzMode="closeable"
          (nzOnClose)="removeSuburb(suburb)"
          nzColor="blue"
          style="margin: 4px;"
        >
          {{ suburb }}
        </nz-tag>
      </div>
    </div>

    <!-- Step 2: Connect Accounts -->
    <div *ngIf="currentStep === 2" class="step-content">
      <h2>{{ steps[2].title }}</h2>
      <p class="subtitle">{{ steps[2].description }}</p>

      <div class="connection-cards">
        <div class="connection-card" [class.connected]="connections.googleCalendar">
          <div class="connection-icon google">
            <i nz-icon nzType="google"></i>
          </div>
          <div class="connection-info">
            <h4>Google Calendar</h4>
            <p>Sync appointments and follow-ups</p>
          </div>
          <button
            nz-button
            [nzType]="connections.googleCalendar ? 'default' : 'primary'"
            (click)="toggleConnection('googleCalendar')"
          >
            {{ connections.googleCalendar ? 'Connected' : 'Connect' }}
          </button>
        </div>

        <div class="connection-card" [class.connected]="connections.outlook">
          <div class="connection-icon outlook">
            <i nz-icon nzType="windows"></i>
          </div>
          <div class="connection-info">
            <h4>Outlook Calendar</h4>
            <p>Sync appointments and emails</p>
          </div>
          <button
            nz-button
            [nzType]="connections.outlook ? 'default' : 'primary'"
            (click)="toggleConnection('outlook')"
          >
            {{ connections.outlook ? 'Connected' : 'Connect' }}
          </button>
        </div>

        <div class="connection-card" [class.connected]="connections.facebook">
          <div class="connection-icon facebook">
            <i nz-icon nzType="facebook" nzTheme="fill"></i>
          </div>
          <div class="connection-info">
            <h4>Facebook Marketplace</h4>
            <p>Track private sellers</p>
          </div>
          <button
            nz-button
            [nzType]="connections.facebook ? 'default' : 'primary'"
            (click)="toggleConnection('facebook')"
          >
            {{ connections.facebook ? 'Connected' : 'Connect' }}
          </button>
        </div>

        <div class="connection-card" [class.connected]="connections.whatsapp">
          <div class="connection-icon whatsapp">
            <i nz-icon nzType="whats-app"></i>
          </div>
          <div class="connection-info">
            <h4>WhatsApp</h4>
            <p>Instant messaging with leads</p>
          </div>
          <button
            nz-button
            [nzType]="connections.whatsapp ? 'default' : 'primary'"
            (click)="toggleConnection('whatsapp')"
          >
            {{ connections.whatsapp ? 'Connected' : 'Connect' }}
          </button>
        </div>
      </div>
    </div>

    <!-- Step 3: Notifications -->
    <div *ngIf="currentStep === 3" class="step-content">
      <h2>{{ steps[3].title }}</h2>
      <p class="subtitle">{{ steps[3].description }}</p>

      <div class="notification-settings">
        <div class="setting-group">
          <h4>Notification Channels</h4>
          
          <label nz-checkbox [(ngModel)]="notifications.email">
            <i nz-icon nzType="mail"></i>
            Email Notifications
          </label>
          
          <label nz-checkbox [(ngModel)]="notifications.sms">
            <i nz-icon nzType="mobile"></i>
            SMS Alerts (High Priority Only)
          </label>
          
          <label nz-checkbox [(ngModel)]="notifications.push">
            <i nz-icon nzType="bell"></i>
            Push Notifications
          </label>
        </div>

        <div class="setting-group">
          <h4>Notification Frequency</h4>
          <nz-radio-group [(ngModel)]="notifications.frequency">
            <label nz-radio nzValue="instant">
              Instant (as they happen)
            </label>
            <label nz-radio nzValue="hourly">
              Hourly Digest
            </label>
            <label nz-radio nzValue="daily">
              Daily Summary
            </label>
          </nz-radio-group>
        </div>

        <nz-alert
          nzType="info"
          nzMessage="You can change these settings anytime from your account preferences"
          nzShowIcon
        ></nz-alert>
      </div>
    </div>

    <!-- Step 4: Complete -->
    <div *ngIf="currentStep === 4" class="step-content complete-step">
      <div class="success-icon">
        <i nz-icon nzType="check-circle" nzTheme="twotone"></i>
      </div>
      <h1>{{ steps[4].title }}</h1>
      <p class="subtitle">{{ steps[4].description }}</p>

      <div class="summary-card">
        <h4>Your Setup Summary</h4>
        <div class="summary-item">
          <i nz-icon nzType="environment"></i>
          <span>{{ selectedSuburbs.length }} suburbs tracked</span>
        </div>
        <div class="summary-item">
          <i nz-icon nzType="link"></i>
          <span>{{ (connections.googleCalendar ? 1 : 0) + (connections.outlook ? 1 : 0) + (connections.facebook ? 1 : 0) + (connections.whatsapp ? 1 : 0) }} accounts connected</span>
        </div>
        <div class="summary-item">
          <i nz-icon nzType="bell"></i>
          <span>Notifications: {{ notifications.frequency }}</span>
        </div>
      </div>

      <button
        nz-button
        nzType="primary"
        nzSize="large"
        [nzLoading]="loading"
        (click)="completeOnboarding()"
      >
        Go to Dashboard
        <i nz-icon nzType="arrow-right"></i>
      </button>
    </div>
  </div>

  <!-- Navigation buttons -->
  <div class="navigation-buttons" *ngIf="currentStep > 0 && currentStep < 4">
    <button nz-button (click)="previous()">
      <i nz-icon nzType="arrow-left"></i>
      Back
    </button>

    <div class="right-buttons">
      <button
        *ngIf="steps[currentStep].skippable"
        nz-button
        nzType="link"
        (click)="skip()"
      >
        Skip
      </button>
      
      <button
        nz-button
        nzType="primary"
        [disabled]="!canProceed"
        (click)="next()"
      >
        Continue
        <i nz-icon nzType="arrow-right"></i>
      </button>
    </div>
  </div>
</div>
